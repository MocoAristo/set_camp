<% content_for(:title, "#{t '.title'}") %>
<div class="container">
  <%= form_with model: @user, local:true do |f| %>
  <%= render 'shared/error_messages', object: f.object %>
  <div class="form-group justify-content-around">
    <div class="image-box">
      <%= f.label :avatar do %>
        <i class="fas fa-camera avatar-edit rounded-circle fa-border"></i>
        <%= f.file_field :avatar, id: :user_avatar, onChange:"imgPreView(event)", style: "display: none;" %>
      <% end %>
      <%if @user.avatar.present?%>
        <%= image_tag @user.avatar.variant(combine_options:{gravity: :center, resize: "200x200^", crop:"200x200+0+0"}), class: "rounded-circle", id: :preview_avatar, style:"height: 200px; width: 200px;" %>
      <% end %>
    </div>
  </div>
  <div class="form-group">
    <%= f.label :name %>
    <input class="form-control" type="text" name="user[name]" id="user_name" value="<%=@user.name%>" />
  </div>
  <div class="form-group">
    <%= f.label :email %>
    <input class="form-control" type="email" name="user[email]" id="user_email" value="<%=@user.email%>" />
  </div>
  <%= f.submit "更新", class: 'btn btn-primary' %>
  <% end %>
</div>

<script>
  function imgPreView(event){
    var fileReader = new FileReader();
    fileReader.onload = (function() {
      document.getElementById('preview_avatar').src = fileReader.result;
    });
    fileReader.readAsDataURL(event.target.files[0]);
    console.log("avatar")
  };
</script>